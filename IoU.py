find_1 = [[[0.571875, 0.1328125, 0.7390625, 0.3203125], [0.5764325, 0.14336506, 0.74978644, 0.3181179]],
          [[0.6578125, 0.0890625, 0.80625, 0.2765625], [0.65550876, 0.09806568, 0.7947731, 0.26844648]],
          [[0.4859375, 0.090625, 0.6375, 0.2203125], [0.4956315, 0.090753555, 0.6404365, 0.23852667]],
          [[0.678125, 0.1578125, 0.7546875, 0.3421875], [0.69197536, 0.15138346, 0.75795424, 0.35368884]],
          [[0.7390625, 0.18125, 0.828125, 0.303125], [0.73944604, 0.18396768, 0.83600724, 0.29076475]],
          [[0.396875, 0.2296875, 0.5390625, 0.4390625], [0.4115808, 0.24938345, 0.5372516, 0.43828565]]]

find_2 = [[[0.4328125, 0.5921875, 0.5578125, 0.88125], [0.44063753, 0.5860781, 0.5553302, 0.8722221]],
          [[0.434375, 0.3484375, 0.58125, 0.5984375], [0.43170986, 0.34820557, 0.57692885, 0.5934552]],
          [[0.1984375, 0.5546875, 0.41875, 0.8046875], [0.21684633, 0.56053895, 0.424101, 0.7920092]],
          [[0.3453125, 0.5921875, 0.475, 0.8859375], [0.346028, 0.5819056, 0.47747788, 0.8942499]],
          [[0.253125, 0.384375, 0.321875, 0.484375], [0.24695966, 0.38998494, 0.3289307, 0.5186903]],
          [[0.5671875, 0.3296875, 0.684375, 0.4703125], [0.57575434, 0.32688332, 0.6861195, 0.5137579]],
          [[0.425, 0.5421875, 0.5546875, 0.71875], [0.42096794, 0.5299876, 0.5668017, 0.7309307]],
          [[0.284375, 0.53125, 0.378125, 0.671875], [0.29124185, 0.53351164, 0.37964568, 0.68344593]],
          [[0.375, 0.55625, 0.5265625, 0.7359375], [0.38335064, 0.5520601, 0.52349377, 0.7435696]],
          [[0.425, 0.6375, 0.6078125, 0.8859375], [0.4151883, 0.6339809, 0.62323296, 0.89040256]],
          [[0.184375, 0.5953125, 0.3875, 0.7125], [0.28898457, 0.60562104, 0.39001575, 0.7188615]],
          [[0.1390625, 0.5765625, 0.29375, 0.7671875], [0.14674866, 0.5681387, 0.2872615, 0.77051103]],
          [[0.2875, 0.6171875, 0.45, 0.88125], [0.29756656, 0.6248582, 0.4502811, 0.87756306]],
          [[0.2265625, 0.578125, 0.415625, 0.8859375], [0.21959758, 0.5732988, 0.43960637, 0.8907268]],
          [[0.4296875, 0.709375, 0.60625, 0.8859375], [0.4333856, 0.6997078, 0.61226416, 0.8859754]],
          [[0.3953125, 0.509375, 0.6359375, 0.8421875], [0.41341996, 0.5103691, 0.6521461, 0.8465763]],
          [[0.2234375, 0.6, 0.396875, 0.8109375], [0.23423034, 0.60570174, 0.39982492, 0.8034225]],
          [[0.3828125, 0.634375, 0.5015625, 0.775], [0.38196883, 0.642784, 0.500181, 0.7804866]],
          [[0.3671875, 0.4890625, 0.6078125, 0.8], [0.36874372, 0.47829193, 0.62104416, 0.8133953]],
          [[0.275, 0.65, 0.4296875, 0.8046875], [0.28232527, 0.6523949, 0.4253515, 0.80413485]],
          [[0.30625, 0.7328125, 0.4453125, 0.9015625], [0.30128208, 0.73855376, 0.44095817, 0.89270115]],
          [[0.4765625, 0.4796875, 0.56875, 0.6953125], [0.48141012, 0.48347893, 0.5710616, 0.7021409]]]

find_3 = [[[0.1265625, 0.109375, 0.8078125, 0.9125], [0.16751647, 0.08859134, 0.7772645, 0.92277217]],
          [[0.240625, 0.0921875, 0.74375, 0.903125], [0.25290737, 0.08451262, 0.7544403, 0.89792395]],
          [[0.1890625, 0.09375, 0.796875, 0.60625], [0.18209419, 0.10540703, 0.8232908, 0.6183914]],
          [[0.109375, 0.11875, 0.903125, 0.90625], [0.09338629, 0.09693706, 0.9123603, 0.8389652]],
          [[0.159375, 0.1046875, 0.83125, 0.90625], [0.15165162, 0.05423549, 0.8448237, 0.91080403]],
          [[0.1078125, 0.45625, 0.9109375, 0.7125], [0.10485774, 0.24499132, 0.92042416, 0.743301]],
          [[0.24375, 0.2890625, 0.79375, 0.6796875], [0.24671617, 0.29048154, 0.7905649, 0.6930696]],
          [[0.375, 0.55625, 0.5265625, 0.7359375], [0.17089188, 0.20638067, 0.7923645, 0.76826745]],
          [[0.096875, 0.103125, 0.9078125, 0.8890625], [0.10958958, 0.09169704, 0.92167854, 0.9090577]],
          [[0.0890625, 0.259375, 0.9125, 0.7140625], [0.09384972, 0.25970477, 0.9140441, 0.72791916]],
          [[0.0578125, 0.2203125, 0.915625, 0.78125], [0.09574789, 0.22483847, 0.92092484, 0.774601]],
          [[0.1078125, 0.0921875, 0.915625, 0.9], [0.0987457, 0.07907614, 0.9110006, 0.90183806]],
          [[0.0765625, 0.084375, 0.9109375, 0.9015625], [0.10125485, 0.08382097, 0.9190601, 0.8860986]],
          [[0.14375, 0.0984375, 0.8609375, 0.9140625], [0.1663653, 0.07183024, 0.8536178, 0.9092519]],
          [[0.15, 0.096875, 0.83125, 0.909375], [0.15663531, 0.093482226, 0.8541852, 0.8541311]],
          [[0.1046875, 0.121875, 0.9078125, 0.8625], [0.12761328, 0.14231783, 0.91940653, 0.84716016]],
          [[0.0953125, 0.1796875, 0.9015625, 0.8015625], [0.09922746, 0.18462655, 0.9145869, 0.80666995]],
          [[0.0984375, 0.2203125, 0.8953125, 0.775], [0.11522138, 0.19497734, 0.9133072, 0.776559]],
          [[0.1734375, 0.1109375, 0.81875, 0.871875], [0.16570538, 0.110084265, 0.8281023, 0.85701954]],
          [[0.0875, 0.1921875, 0.6015625, 0.8640625], [0.11210662, 0.19996652, 0.59879273, 0.8417014]],
          [[0.0890625, 0.0984375, 0.903125, 0.8984375], [0.10268599, 0.09800589, 0.89167994, 0.89461446]],
          [[0.2390625, 0.0859375, 0.6484375, 0.728125], [0.2459746, 0.103212655, 0.63404626, 0.7179901]]]                   

find_5 = [[[0.1265625, 0.1078125, 0.7703125, 0.5015625], [0.20452783, 0.098773375, 0.73958564, 0.49937767]],
          [[0.2359375, 0.10625, 0.7609375, 0.4375], [0.26731342, 0.10261521, 0.75465256, 0.43982288]],
          [[0.1828125, 0.0890625, 0.7828125, 0.3], [0.19162896, 0.10593397, 0.7706001, 0.30744997]],
          [[0.1203125, 0.26875, 0.4375, 0.390625], [0.10101363, 0.276973, 0.4461319, 0.40256363]],
          [[0.15625, 0.2078125, 0.796875, 0.4671875], [0.16412216, 0.21617831, 0.78981465, 0.44241655]],
          [[0.1640625, 0.0984375, 0.821875, 0.4015625], [0.15926465, 0.09461318, 0.82804084, 0.40697396]],
          [[0.6328125, 0.4953125, 0.75, 0.6140625], [0.15587267, 0.09431085, 0.81880295, 0.31398064]],
          [[0.2234375, 0.6, 0.396875, 0.8109375], [0.14805806, 0.14414729, 0.8809053, 0.3485886]],
          [[0.0984375, 0.215625, 0.903125, 0.4390625], [0.08961281, 0.20099781, 0.91418326, 0.4328398]],
          [[0.171875, 0.1171875, 0.8171875, 0.471875], [0.17049962, 0.11281113, 0.8208359, 0.48130447]],
          [[0.0890625, 0.2015625, 0.5984375, 0.5296875], [0.1097869, 0.20322405, 0.59240294, 0.5417306]],
          [[0.2375, 0.0796875, 0.646875, 0.34375], [0.24057305, 0.09746788, 0.64826745, 0.33948895]]]


find_6 = [[[0.1390625, 0.10625, 0.81875, 0.45625], [0.094750255, 0.105893865, 0.9020897, 0.45020306]],
          [[0.16875, 0.1796875, 0.803125, 0.496875], [0.16959584, 0.17205061, 0.8056665, 0.49405998]],
          [[0.25, 0.3046875, 0.8046875, 0.4546875], [0.24325669, 0.29527026, 0.7822168, 0.45327997]],
          [[0.1015625, 0.275, 0.9078125, 0.509375], [0.11245069, 0.2805903, 0.88670635, 0.49890804]],
          [[0.0921875, 0.2359375, 0.9078125, 0.5421875], [0.09806383, 0.26504725, 0.919991, 0.5243535]],
          [[0.115625, 0.103125, 0.8625, 0.428125], [0.114748865, 0.09803377, 0.88745654, 0.4182498]],
          [[0.0890625, 0.096875, 0.9, 0.471875], [0.111480236, 0.101466715, 0.90277934, 0.46386367]],
          [[0.10625, 0.1921875, 0.878125, 0.5015625], [0.106227785, 0.20652135, 0.9132128, 0.49190217]],
          [[0.1, 0.1046875, 0.8859375, 0.5125], [0.12034631, 0.09276244, 0.8761245, 0.5179384]]]

find_7 = [[[0.18125, 0.596875, 0.2953125, 0.721875], [0.1878646, 0.58710456, 0.30434084, 0.7157575]],
          [[0.3, 0.459375, 0.4375, 0.64375], [0.29648027, 0.46136528, 0.44073793, 0.64628226]],
          [[0.5453125, 0.453125, 0.7, 0.621875], [0.5422712, 0.46098086, 0.690846, 0.6190087]],
          [[0.23125, 0.3671875, 0.3859375, 0.5234375], [0.23884982, 0.36144096, 0.3817436, 0.5317975]],
          [[0.59375, 0.3984375, 0.7296875, 0.521875], [0.59283596, 0.40037295, 0.72924656, 0.5172772]],
          [[0.56875, 0.4734375, 0.7734375, 0.590625], [0.5756985, 0.4737453, 0.76747954, 0.59609574]],
          [[0.221875, 0.5390625, 0.33125, 0.653125], [0.22164491, 0.5332603, 0.3333136, 0.6603548]],
          [[0.3375, 0.325, 0.425, 0.4078125], [0.3403633, 0.32666805, 0.4296882, 0.40907958]],
          [[0.2015625, 0.5453125, 0.334375, 0.6375], [0.19212143, 0.5327813, 0.33881336, 0.64321965]],
          [[0.6265625, 0.5328125, 0.746875, 0.6234375], [0.62525004, 0.5242696, 0.7567461, 0.6331954]],
          [[0.725, 0.30625, 0.815625, 0.38125], [0.72520137, 0.30933833, 0.8226826, 0.38883257]],
          [[0.421875, 0.4875, 0.60625, 0.5765625], [0.433765, 0.4834549, 0.5892462, 0.57730293]],
          [[0.3078125, 0.359375, 0.3421875, 0.41875], [0.30377468, 0.3519837, 0.34930745, 0.4096646]],
          [[0.5625, 0.428125, 0.6578125, 0.5234375], [0.5737609, 0.42233375, 0.6661317, 0.5251464]],
          [[0.2984375, 0.56875, 0.38125, 0.6515625], [0.28941104, 0.55452216, 0.37627575, 0.65954256]],
          [[0.6234375, 0.5234375, 0.7, 0.5875], [0.6213393, 0.51750785, 0.7033515, 0.6002535]],
          [[0.1734375, 0.50625, 0.253125, 0.5796875], [0.16793703, 0.5076694, 0.25244534, 0.5870519]],
          [[0.3921875, 0.5265625, 0.4671875, 0.596875], [0.39233938, 0.5245305, 0.47661397, 0.60583586]],
          [[0.515625, 0.578125, 0.5890625, 0.721875], [0.5170805, 0.5668048, 0.60062224, 0.7278115]],
          [[0.625, 0.565625, 0.70625, 0.728125], [0.6201413, 0.56878275, 0.70533496, 0.73230547]],
          [[0.565625, 0.365625, 0.6546875, 0.45], [0.56466466, 0.35837203, 0.6596872, 0.46180487]],
          [[0.1796875, 0.4125, 0.3171875, 0.565625], [0.17505208, 0.43279183, 0.32883206, 0.56995046]],
          [[0.5, 0.428125, 0.66875, 0.5921875], [0.5089138, 0.4235131, 0.6717488, 0.5951217]],
          [[0.765625, 0.4328125, 0.865625, 0.6078125], [0.762381, 0.42982525, 0.873779, 0.61522275]],
          [[0.2859375, 0.24375, 0.3796875, 0.3375], [0.29590407, 0.24811298, 0.38393334, 0.341191]],
          [[0.621875, 0.51875, 0.8296875, 0.68125], [0.6477909, 0.53742814, 0.8320229, 0.67504954]],       
          [[0.25, 0.43125, 0.3625, 0.603125], [0.2551265, 0.44563523, 0.36445704, 0.6057186]],
          [[0.425, 0.43125, 0.571875, 0.565625], [0.42519197, 0.4213454, 0.57422626, 0.5752138]],
          [[0.653125, 0.41875, 0.7625, 0.578125], [0.65174824, 0.40902507, 0.7776821, 0.5804662]],
          [[0.6765625, 0.6796875, 0.775, 0.8390625], [0.6755249, 0.68654686, 0.7786843, 0.8415709]],
          [[0.2796875, 0.7046875, 0.3703125, 0.8265625], [0.26728025, 0.7054701, 0.37437955, 0.83704436]],
          [[0.221875, 0.459375, 0.3703125, 0.6140625], [0.22224323, 0.4556902, 0.38187534, 0.61841077]],
          [[0.6328125, 0.4953125, 0.75, 0.6140625], [0.63505155, 0.48556155, 0.754258, 0.62245184]],
          [[0.1875, 0.415625, 0.384375, 0.6109375], [0.19439131, 0.4196711, 0.4048441, 0.6018551]],
          [[0.6609375, 0.41875, 0.8375, 0.565625], [0.66368526, 0.42117035, 0.84593123, 0.5676656]],
          [[0.5640625, 0.5078125, 0.671875, 0.690625], [0.5649342, 0.49257326, 0.67275554, 0.6904342]],
          [[0.2703125, 0.4328125, 0.3765625, 0.553125], [0.25495186, 0.44538504, 0.38359573, 0.56036454]],
          [[0.5484375, 0.4328125, 0.690625, 0.578125], [0.5300437, 0.44518182, 0.69048035, 0.57542706]],
          [[0.4203125, 0.2953125, 0.56875, 0.4296875], [0.42563736, 0.30064523, 0.5654555, 0.43367893]],
          [[0.3125, 0.246875, 0.4546875, 0.4390625], [0.32229164, 0.2371541, 0.46196374, 0.4435297]],
          [[0.5015625, 0.234375, 0.6265625, 0.4140625], [0.50578105, 0.23269083, 0.6189009, 0.41500986]],
          [[0.1734375, 0.54375, 0.2890625, 0.6421875], [0.17857896, 0.5441789, 0.2919852, 0.6423035]],
          [[0.3765625, 0.5625, 0.490625, 0.65625], [0.38324806, 0.55713266, 0.49333963, 0.6543407]],
          [[0.1703125, 0.5296875, 0.2796875, 0.6328125], [0.16078301, 0.532296, 0.29333377, 0.6395723]],
          [[0.1640625, 0.7328125, 0.2890625, 0.8359375], [0.16342902, 0.7304149, 0.28638452, 0.8442771]],
          [[0.4203125, 0.5296875, 0.5453125, 0.61875], [0.41260466, 0.5205647, 0.53720295, 0.6267415]],
          [[0.5765625, 0.4859375, 0.6828125, 0.565625], [0.57703537, 0.4738421, 0.6892378, 0.57802105]],
          [[0.7421875, 0.41875, 0.84375, 0.4953125], [0.74254984, 0.40791884, 0.8418816, 0.49612066]],
          [[0.5734375, 0.6796875, 0.7109375, 0.778125], [0.5833769, 0.68234015, 0.7103932, 0.77847373]],
          [[0.703125, 0.6046875, 0.84375, 0.69375], [0.7293065, 0.60834557, 0.8436778, 0.70424026]],
          [[0.3015625, 0.3734375, 0.4625, 0.590625], [0.3044113, 0.37457198, 0.46692377, 0.59466964]]]

# class = {1: "chimney", 
#          2: "door",
#          3: "house", 
#          4: "roof1", 
#          5: "roof2", 
#          6: "roof3", 
#          7: "window"}

def IoU(box):
    box1 = box[0]
    box2 = box[1]
    # box = (x1, y1, x2, y2)
    box1_area = (box1[2] - box1[0] + 1) * (box1[3] - box1[1] + 1)
    box2_area = (box2[2] - box2[0] + 1) * (box2[3] - box2[1] + 1)

    # obtain x1, y1, x2, y2 of the intersection
    x1 = max(box1[0], box2[0])
    y1 = max(box1[1], box2[1])
    x2 = min(box1[2], box2[2])
    y2 = min(box1[3], box2[3])

    # compute the width and height of the intersection
    w = max(0, x2 - x1 + 1)
    h = max(0, y2 - y1 + 1)

    inter = w * h
    iou = inter / (box1_area + box2_area - inter)
    return iou
'''
#-------------------------------#
import matplotlib.pyplot as plt

def get_graph(iou_list):
    precision_list = []
    for i in range(100):
        th = 0.01*i
        
        TP = 0
        FP = 0

        for iou in iou_list:
            if iou > th:
                TP += 1
            else:
                FP += 1
        
        precision_list.append(TP/(TP+FP))

    plt.plot(precision_list)
    plt.show()

get_graph(get_IoU(find_1))
get_graph(get_IoU(find_2))
get_graph(get_IoU(find_3))
get_graph(get_IoU(find_5))
get_graph(get_IoU(find_6))
get_graph(get_IoU(find_7))
'''
def get_IoU(find_list):
    iou_list = []
    for n in find_list:
        iou_list.append(IoU(n))
    return iou_list

def get_graph(iou_list):
    precision_list=[]
    th = 0.9

    TP = 0
    FP = 0

    for iou in iou_list:
        if iou > th:
            TP += 1
        else:
            FP += 1

    precision_list.append(TP/(TP+FP))
    return precision_list

print(get_graph(get_IoU(find_1)))
print(get_graph(get_IoU(find_2)))
print(get_graph(get_IoU(find_3)))
print(get_graph(get_IoU(find_5)))
print(get_graph(get_IoU(find_6)))
print(get_graph(get_IoU(find_7)))